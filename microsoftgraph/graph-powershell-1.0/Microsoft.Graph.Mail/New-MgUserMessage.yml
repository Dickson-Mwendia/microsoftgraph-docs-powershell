### YamlMime:PowershellCmdlet
summary: |-
  Create an open extension (openTypeExtension object) and add custom properties in a new or existing instance of a resource.
  You can create an open extension in a resource instance and store custom data to it all in the same operation, except for specific resources.
  See known limitations of open extensions for more information.
  The table in the Permissions section lists the resources that support open extensions.

  > [!NOTE]
  > To view the beta release of this cmdlet, view [New-MgBetaUserMessage](/powershell/module/Microsoft.Graph.Beta.Mail/New-MgBetaUserMessage?view=graph-powershell-beta)
module: Microsoft.Graph.Mail
notes: |-
  ALIASES

  COMPLEX PARAMETER PROPERTIES

  To create the parameters described below, construct a hash table containing the appropriate properties. For information on hash tables, run Get-Help about_Hash_Tables.


  `INPUTOBJECT <IMailIdentity>`: Identity Parameter
    - `[AttachmentId <String>]`: The unique identifier of attachment
    - `[ExtensionId <String>]`: The unique identifier of extension
    - `[InferenceClassificationOverrideId <String>]`: The unique identifier of inferenceClassificationOverride
    - `[MailFolderId <String>]`: The unique identifier of mailFolder
    - `[MailFolderId1 <String>]`: The unique identifier of mailFolder
    - `[MessageId <String>]`: The unique identifier of message
    - `[MessageRuleId <String>]`: The unique identifier of messageRule
    - `[UserId <String>]`: The unique identifier of user
inputs:
- name: <xref href="Microsoft.Graph.PowerShell.Models.IMailIdentity" data-throw-if-not-resolved="False" />
  description: ""
- name: <xref href="System.Collections.Hashtable" data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href="System.String" data-throw-if-not-resolved="False" />
  description: ""
links:
- text: New-MgBetaUserMessage
  href: /powershell/module/Microsoft.Graph.Beta.Mail/New-MgBetaUserMessage?view=graph-powershell-beta
syntaxes:
- >-
  New-MgUserMailFolderMessageExtension -MailFolderId <String> -MessageId <String> -UserId <String>

   [-AdditionalProperties <Hashtable>] [-Id <String>] [-WhatIf] [-Confirm] [<CommonParameters>]
- >-
  New-MgUserMailFolderMessageExtension -MailFolderId <String> -MessageId <String> -UserId <String>

   -BodyParameter <Hashtable> [-WhatIf] [-Confirm] [<CommonParameters>]
- >-
  New-MgUserMailFolderMessageExtension -InputObject <IMailIdentity> [-AdditionalProperties <Hashtable>]

   [-Id <String>] [-WhatIf] [-Confirm] [<CommonParameters>]
- >-
  New-MgUserMailFolderMessageExtension -InputObject <IMailIdentity> -BodyParameter <Hashtable> [-WhatIf]

   [-Confirm] [<CommonParameters>]
examples:
- title: 'Example 1: Code snippet'
  code: |-
    Import-Module Microsoft.Graph.Mail

    $params = @{
    	subject = "Did you see last night's game?"
    	importance = "Low"
    	body = @{
    		contentType = "HTML"
    		content = "They were &lt;b&gt;awesome&lt;/b&gt;!"
    	}
    	toRecipients = @(
    		@{
    			emailAddress = @{
    				address = "AdeleV@contoso.onmicrosoft.com"
    			}
    		}
    	)
    }

    # A UPN can also be used as -UserId.
    New-MgUserMessage -UserId $userId -BodyParameter $params
  description: |-
    This example shows how to use the New-MgUserMessage Cmdlet.

    To learn about permissions for this resource, see the [permissions reference](/graph/permissions-reference).
  summary: ""
- title: 'Example 2: Code snippet'
  code: |-
    Import-Module Microsoft.Graph.Mail

    $params = @{
    	subject = "9/8/2018: concert"
    	body = @{
    		contentType = "HTML"
    		content = "The group represents Washington."
    	}
    	toRecipients = @(
    		@{
    			emailAddress = @{
    				address = "AlexW@contoso.OnMicrosoft.com"
    			}
    		}
    	)
    	internetMessageHeaders = @(
    		@{
    			name = "x-custom-header-group-name"
    			value = "Washington"
    		}
    		@{
    			name = "x-custom-header-group-id"
    			value = "WA001"
    		}
    	)
    }

    # A UPN can also be used as -UserId.
    New-MgUserMessage -UserId $userId -BodyParameter $params
  description: |-
    This example shows how to use the New-MgUserMessage Cmdlet.

    To learn about permissions for this resource, see the [permissions reference](/graph/permissions-reference).
  summary: ""
parameters:
- type: <xref href="Hashtable" data-throw-if-not-resolved="False" />
  name: AdditionalProperties
  description: |+
    Additional Parameters

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Hashtable" data-throw-if-not-resolved="False" />
  name: BodyParameter
  isRequired: true
  description: |+
    extension

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    Prompts you for confirmation before running the cmdlet.

  defaultValue: None
  position: Named
  aliases: cf
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Id
  description: |+
    The unique idenfier for an entity.
    Read-only.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="IMailIdentity" data-throw-if-not-resolved="False" />
  name: InputObject
  isRequired: true
  description: |+
    Identity Parameter
    To construct, see NOTES section for INPUTOBJECT properties and create a hash table.

  defaultValue: None
  pipelineInput: true
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: MailFolderId
  isRequired: true
  description: |+
    The unique identifier of mailFolder

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: MessageId
  isRequired: true
  description: |+
    The unique identifier of message

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: UserId
  isRequired: true
  description: |+
    The unique identifier of user

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    Shows what would happen if the cmdlet runs.
    The cmdlet is not run.

  defaultValue: None
  position: Named
  aliases: wi
  parameterValueGroup: ""
uid: Microsoft.Graph.Mail.New-MgUserMessage
name: New-MgUserMessage
description: |-
  Create an open extension (openTypeExtension object) and add custom properties in a new or existing instance of a resource.
  You can create an open extension in a resource instance and store custom data to it all in the same operation, except for specific resources.
  See known limitations of open extensions for more information.
  The table in the Permissions section lists the resources that support open extensions.
metadata:
  external help file: Microsoft.Graph.Mail-help.xml
  Module Name: Microsoft.Graph.Mail
  online version: https://learn.microsoft.com/powershell/module/microsoft.graph.mail/new-mgusermailfoldermessageextension
  schema: 2.0.0
